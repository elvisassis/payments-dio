package br.com.elvisassis.payments.domain;import br.com.elvisassis.payments.exceptions.PaymentStatusException;import jakarta.persistence.*;import lombok.AccessLevel;import lombok.Data;import lombok.Getter;import lombok.NoArgsConstructor;import java.math.BigDecimal;import java.util.UUID;@Entity@Table(name = "payments")@Getter@NoArgsConstructor(access = AccessLevel.PROTECTED)public class Payment {    @Id    @GeneratedValue(strategy = GenerationType.UUID)    private UUID id;    private BigDecimal amount;    private String currency;    @Enumerated(EnumType.STRING)    private PaymentStatus status;    @Enumerated(EnumType.STRING)    private PaymentMethod method;    private String provider;    public static Payment create(BigDecimal amount,                                 String currency,                                 PaymentMethod method,                                 String provider,                                 String externalTransactionId) {        Payment payment = new Payment();        payment.amount = amount;        payment.currency = currency;        payment.method = method;        payment.status = PaymentStatus.CREATED;        payment.provider = provider;        return payment;    }    private String externalTransactionId;    public void markAsProcessing() {        if (this.status != PaymentStatus.CREATED) {            throw new PaymentStatusException("Payment must be in CREATED status to be marked as PROCESSING.");        }        this.status = PaymentStatus.PROCESSING;    }    public void markAsApproved(String provider, String externalTransactionId) {        if(this.status != PaymentStatus.PROCESSING) {            throw new PaymentStatusException("Payment must be in PROCESSING status to be marked as APPROVED.");        }        this.status = PaymentStatus.APPROVED;        this.provider = provider;        this.externalTransactionId = externalTransactionId;    }    public void markAsFailed() {        if(this.status != PaymentStatus.PROCESSING) {            throw new PaymentStatusException("Payment must be in PROCESSING status to be marked as FAILED.");        }        this.status = PaymentStatus.FAILED;        this.provider = provider;    }}